{% load static %}
{% load i18n %}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Web store{% if title %} - {{ title }}{% endif %}</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap 5 Bundle JS (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-light bg-white border-bottom sticky-top" style="z-index: 1040;">

      <div class="container-fluid">
        <a class="navbar-brand" href="{% url 'e_store:home' %}">Web store</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto mb-2 mb-md-0">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'e_store:home' %}">
                <i class="bi bi-house-door-fill"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'e_store:cart' %}">
                 <i class="bi bi-cart-fill"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'e_store:order_history' %}">
                <i class="bi bi-clock-history"></i>
              </a>
            </li>
            <li class="nav-item d-flex align-items-center ms-md-3">
              <form action="{% url 'set_language' %}" method="post" class="d-flex align-items-center">
                {% csrf_token %}
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-2" viewBox="0 0 24 24">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="2" y1="12" x2="22" y2="12"/>
                  <path d="M12 2a15.3 15.3 0 0 1 0 20a15.3 15.3 0 0 1 0-20z"/>
                </svg>

                <select name="language" class="form-select form-select-sm ms-2" onchange="this.form.submit()">
                  {% for lang_code, lang_name in LANGUAGES %}
                    <option value="{{ lang_code }}" {% if lang_code == LANGUAGE_CODE %}selected{% endif %}>
                      {{ lang_name }}
                    </option>
                  {% endfor %}
                </select>
              </form>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main class="container">
      <div class="sticky-top bg-white pb-2 mb-3 border-bottom shadow-sm" style="z-index: 1030; top: 57px;">
        <div class="container">
          {% block page_header %}{% endblock %}
        </div>
      </div>

      {% if messages %}
        <div class="container">
          <ul class="list-unstyled">
            {% for message in messages %}
              <li class="alert alert-{{ message.tags }}">{{ message }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <div>
        {% block content %}{% endblock %}
      </div>
    </main>
    {% block modals %}
      <div class="modal fade" id="cancelModal" tabindex="-1" style="z-index: 1055;" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">{% trans "Confirm Cancellation" %}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                {% trans "Are you sure you want to cancel this order? This action cannot be undone." %}
              </div>
              <div class="modal-footer">
                <form method="post">
                  {% csrf_token %}
                  <button type="submit" name="cancel_order" value="{{ order.id }}" class="btn btn-danger">
                    {% trans "Yes, Cancel" %}
                  </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{% trans "No" %}</button>
                </form>
              </div>
            </div>
          </div>
        </div>
    {% endblock %}
  </body>

</html>
